<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ë©ì„DB</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/search.css' %}">
</head>
<body>
    <h5 style="text-align: right;">
        <a href="{% url 'history:version' %}" target="_blank" style="text-decoration: none;">v0.2 ê³µì—° ì—°ë„ ì¶”ê°€</a>
    </h5>
    <div class="search-form">
        <form method="get" action="{% url 'history:search' %}">
            <input type="text" name="q" value="{{ query }}" placeholder="ì´ë¦„ì´ë‚˜ ê³µì—°ì„ ê²€ìƒ‰í•˜ì„¸ìš”" autocomplete="off">
            <button type="submit">ê²€ìƒ‰</button>
        </form>
    </div>

    <hr>
    {% if not selected_object %}
        <h3>ê²€ìƒ‰ ê²°ê³¼</h3>

        <h4>ğŸ‘¤ íšŒì›</h4>
        <div class="card-container">
            {% for member in members %}
                <a href="{% url 'history:member_detail' member.pk %}?q={{ query }}" class="card-link">
                    <div class="card">
                        {{ member.member_name }}{% if member.member_class %} ({{ member.member_class }}ê¸°){% endif %}
                    </div>
                </a>
            {% empty %}
                <p>íšŒì› ì—†ìŒ</p>
            {% endfor %}
        </div>

        <h4>ğŸ­ ê³µì—°</h4>
        <div class="card-container">
            {% for play in plays %}
                <a href="{% url 'history:play_detail' play.pk %}?q={{ query }}" class="card-link">
                    <div class="card">
                        {{ play.play_name }} ( {{ play.play_date }} )
                    </div>
                </a>
            {% empty %}
                <p>ê³µì—° ì—†ìŒ</p>
            {% endfor %}
        </div>
    {% else %}
        {% if selected_type == "member" %}
            <h1 style="text-align: center;">ğŸ‘¤{{ selected_object.member_name }}</h1>

            <h2>ğŸ­ ì°¸ì—¬ ê³µì—°</h2>
            <h3>ğŸ‘¥ ë°°ìš°</h3>
            <ul>
                {% if selected_type == "member" %}
                    {% for play_name, roles in participation_actor.items %}
                        <li><b>{{ play_name }}</b> : {{ roles|join:", " }}</li>
                    {% empty %}
                        <li>ì°¸ì—¬ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</li>
                    {% endfor %}
                {% endif %}
            </ul>
            <h3>ğŸ› ï¸ğŸ§°ğŸ‘— ìŠ¤íƒ­</h3>
            <ul>
                {% for play_name, roles in participation_staff.items %}
                    <li><b>{{ play_name }}</b> : {{ roles|join:", " }}</li>
                {% empty %}
                    <li>ì°¸ì—¬ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</li>
                {% endfor %}
            </ul>
        {% elif selected_type == "play" %}
            <h1 style="text-align: center;">ğŸ­{{ selected_object.play_name }}</h1>

            <h2>{{ selected_play_type.keyword }}</h2>
            <h2>ğŸ“… ê³µì—°ì¼</h2>
            <ul>
                {% for play_date in selected_play_dates %}
                    <li>{{ play_date.play_date|date:"Yë…„ mì›” dì¼ H:i" }}</li>
                {% empty %}
                    <li>ê³µì—° ë‚ ì§œê°€ ì—†ìŠµë‹ˆë‹¤.</li>
                {% endfor %}
            </ul>
            <h2>ğŸ‘¤ ì°¸ì—¬ì</h2>
            <h3>ğŸ¬ ì—°ì¶œì§„</h3>
            <ul>
                {% for roles, member_name in director_map.items %}
                    <li><b>{{ roles }}</b> : {{ member_name|join:", " }}</li>
                {% empty %}
                    <li>ì°¸ì—¬ìê°€ ì—†ìŠµë‹ˆë‹¤.</li>
                {% endfor %}
            </ul>
            <h3>ğŸ‘¥ ë°°ìš°</h3>
            <ul>
                {% for member_name, roles in actor_map.items %}
                    <li><b>{{ member_name }}</b> : {{ roles|join:", " }}</li>
                {% empty %}
                    <li>ì°¸ì—¬ìê°€ ì—†ìŠµë‹ˆë‹¤.</li>
                {% endfor %}
            </ul>
            <h3>ğŸ› ï¸ğŸ§°ğŸ‘— ìŠ¤íƒ­</h3>
            <ul>
                {% for roles, member_name in staff_map.items %}
                    <li><b>{{ roles }}</b> : {{ member_name|join:", " }}</li>
                {% empty %}
                    <li>ì°¸ì—¬ìê°€ ì—†ìŠµë‹ˆë‹¤.</li>
                {% endfor %}
            </ul>
        {% endif %}
        <a href="{% url 'history:search' %}?q={{ query }}">â† ê²€ìƒ‰ ê²°ê³¼ë¡œ ëŒì•„ê°€ê¸°</a>
    {% endif %}
</body>
</html>
